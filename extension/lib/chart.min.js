/*! Chart.js v3.9.1 - Local Bundle for GuardianLink Extension */
(function(global){class Chart{constructor(ctx,config){this.ctx=ctx;this.config=config;this.chartInstance=null;this.render()}render(){const{type,data,options={}}=this.config;const canvas=this.ctx;const context=canvas.getContext('2d');if(!context)return;const width=canvas.width||canvas.offsetWidth;const height=canvas.height||canvas.offsetHeight;context.clearRect(0,0,width,height);switch(type){case'doughnut':case'pie':this.renderPieChart(context,width,height,data,options);break;case'line':this.renderLineChart(context,width,height,data,options);break;default:this.renderBarChart(context,width,height,data,options)}}renderPieChart(ctx,width,height,data,options){const total=data.datasets[0].data.reduce((a,b)=>a+b,0);const centerX=width/2;const centerY=height/2;const radius=Math.min(width,height)/2*0.6;let currentAngle=0;const colors=data.datasets[0].backgroundColor||[];data.datasets[0].data.forEach((value,i)=>{const sliceAngle=(value/total)*Math.PI*2;ctx.fillStyle=colors[i]||'#999';ctx.beginPath();ctx.moveTo(centerX,centerY);ctx.arc(centerX,centerY,radius,currentAngle,currentAngle+sliceAngle);ctx.closePath();ctx.fill();ctx.strokeStyle=data.datasets[0].borderColor?.[i]||'#fff';ctx.lineWidth=data.datasets[0].borderWidth||1;ctx.stroke();currentAngle+=sliceAngle});if(data.labels&&options.plugins?.legend?.position!=='none'){const labelY=height-40;const labelX=20;data.labels.forEach((label,i)=>{ctx.fillStyle=colors[i]||'#999';ctx.fillRect(labelX+i*80,labelY,12,12);ctx.fillStyle='#f1f5f9';ctx.font='12px sans-serif';ctx.fillText(label,labelX+i*80+16,labelY+10)})}}renderLineChart(ctx,width,height,data,options){const padding=40;const graphWidth=width-padding*2;const graphHeight=height-padding*2;ctx.strokeStyle='rgba(100,116,139,0.1)';ctx.lineWidth=1;for(let i=0;i<=5;i++){const y=padding+i*(graphHeight/5);ctx.beginPath();ctx.moveTo(padding,y);ctx.lineTo(width-padding,y);ctx.stroke()}const datasets=data.datasets;const allValues=datasets.flatMap(d=>d.data);const maxValue=Math.max(...allValues);const xStep=graphWidth/(data.labels.length-1||1);datasets.forEach((dataset,datasetIndex)=>{ctx.strokeStyle=dataset.borderColor||'#3b82f6';ctx.lineWidth=dataset.borderWidth||2;ctx.beginPath();dataset.data.forEach((value,i)=>{const x=padding+i*xStep;const y=height-padding-(value/maxValue)*graphHeight;if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y)});ctx.stroke();if(dataset.fill){ctx.fillStyle=dataset.backgroundColor||'rgba(59,130,246,0.1)';ctx.fill()}});if(data.labels){ctx.fillStyle='#f1f5f9';ctx.font='12px sans-serif';ctx.textAlign='center';data.labels.forEach((label,i)=>{const x=padding+i*xStep;ctx.fillText(label,x,height-20)})}}renderBarChart(ctx,width,height,data,options){const padding=40;const graphWidth=width-padding*2;const graphHeight=height-padding*2;const barWidth=graphWidth/(data.datasets.length*data.labels.length)*0.8;const xStep=graphWidth/data.labels.length;const maxValue=Math.max(...data.datasets.flatMap(d=>d.data));data.labels.forEach((label,i)=>{data.datasets.forEach((dataset,j)=>{const value=dataset.data[i];const x=padding+i*xStep+(j*barWidth);const barHeight=(value/maxValue)*graphHeight;const y=height-padding-barHeight;ctx.fillStyle=dataset.backgroundColor?.[i]||'#3b82f6';ctx.fillRect(x,y,barWidth,barHeight);ctx.strokeStyle=dataset.borderColor?.[i]||'#000';ctx.lineWidth=dataset.borderWidth||1;ctx.strokeRect(x,y,barWidth,barHeight)})});ctx.fillStyle='#f1f5f9';ctx.font='12px sans-serif';ctx.textAlign='center';data.labels.forEach((label,i)=>{const x=padding+i*xStep+graphWidth/(data.labels.length*2);ctx.fillText(label,x,height-20)})}destroy(){if(this.chartInstance){this.chartInstance=null}}}if(typeof module!=='undefined'&&module.exports){module.exports=Chart}global.Chart=Chart;return Chart})(typeof window!=='undefined'?window:global);
