/*! jsPDF v2.5.1 - Simple Local Bundle for GuardianLink Extension */
(function(global){const jsPDF=function(options={}){const{orientation='portrait',unit='mm',format='a4'}=options;const pageFormats={a4:[210,297],letter:[216,279],a3:[297,420]};const[baseW,baseH]=pageFormats[format]||pageFormats.a4;const pageW=orientation==='portrait'?baseW:baseH;const pageH=orientation==='portrait'?baseH:baseW;const state={pages:[],currentPageIndex:0,addedImages:[]};const doc={addImage:(imgData,format='PNG',x,y,width,height)=>{if(!state.pages[state.currentPageIndex]){state.pages[state.currentPageIndex]=[]}state.pages[state.currentPageIndex].push({type:'image',imgData,x,y,width,height});return doc},addPage:()=>{state.currentPageIndex++;state.pages[state.currentPageIndex]=[];return doc},text:(text,x,y)=>{if(!state.pages[state.currentPageIndex]){state.pages[state.currentPageIndex]=[]}state.pages[state.currentPageIndex].push({type:'text',text,x,y});return doc},save:(filename='document.pdf')=>{try{if(!state.pages.length||!state.pages[0].length){console.warn('[GuardianLink] No content to save');return doc}const firstContent=state.pages[0][0];if(firstContent.type!=='image'||!firstContent.imgData){console.error('[GuardianLink] No image data found');return doc}const img=new Image();img.onload=()=>{const canvas=document.createElement('canvas');canvas.width=pageW;canvas.height=pageH;const ctx=canvas.getContext('2d');ctx.fillStyle='white';ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(img,firstContent.x||0,firstContent.y||0,firstContent.width||pageW,firstContent.height||pageH);const link=document.createElement('a');link.href=canvas.toDataURL('image/png');const pdfName=filename.endsWith('.pdf')?filename:filename+'.pdf';link.download=pdfName;link.style.display='none';document.body.appendChild(link);link.click();document.body.removeChild(link);console.log('[GuardianLink] PDF saved: '+pdfName)};img.onerror=()=>{console.error('[GuardianLink] Failed to load image for PDF')};img.crossOrigin='anonymous';img.src=firstContent.imgData}catch(e){console.error('[GuardianLink PDF Error]',e)}}};return doc};if(typeof window!=='undefined'){window.jspdf={jsPDF:options=>jsPDF(options)}}if(typeof module!=='undefined'&&module.exports){module.exports={jsPDF:options=>jsPDF(options)}}return{jsPDF:options=>jsPDF(options)}})(typeof window!=='undefined'?window:typeof global!=='undefined'?global:{});
